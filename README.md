# ΧΧ—ΧΧ§Χ Χ›Χ΅Χ¤Χ™Χ - Χ¤Χ¨Χ•Χ™Χ§Χ Χ‘Χ΅Χ™Χ΅Χ™ Χ ΧΧ•Χ Χ™Χ

**Χ©ΧΧ•Χ Χ”ΧΧ’Χ™Χ©Χ•Χ:**  
- Χ•Χ§Χ Χ™Χ Χ”Χ“Χ΅ ΧΧ΅ΧΧ¨ β€“ 324966993  
- Χ™Χ©Χ¨ΧΧΧ™ ΧΧ”Χ™ΧΧ” β€“ 325119493  

**Χ©Χ Χ”ΧΧΆΧ¨Χ›Χ:**  
Χ Χ™Χ”Χ•Χ Χ›Χ΅Χ¤Χ™Χ Χ‘Χ™Χ§Χ‘  
**Χ”Χ™Χ—Χ™Χ“Χ” Χ”Χ Χ‘Χ—Χ¨Χ:**  
ΧΧ—ΧΧ§Χ Χ›Χ΅Χ¤Χ™Χ

---

## ΧΧ•Χ›Χ ΧΆΧ Χ™Χ™Χ Χ™Χ

1. [ΧΧ‘Χ•Χ](#ΧΧ‘Χ•Χ)
2. [ΧΧ¨Χ©Χ™Χ ERD](#ΧΧ¨Χ©Χ™Χ-erd)
3. [ΧΧ¨Χ©Χ™Χ DSD](#ΧΧ¨Χ©Χ™Χ-dsd)
4. [Χ”Χ—ΧΧΧ•Χ ΧΆΧ™Χ¦Χ•Χ‘](#Χ”Χ—ΧΧΧ•Χ-ΧΆΧ™Χ¦Χ•Χ‘)
5. [Χ©Χ™ΧΧ•Χ Χ”Χ›Χ Χ΅Χ Χ ΧΧ•Χ Χ™Χ](#Χ©Χ™ΧΧ•Χ-Χ”Χ›Χ Χ΅Χ-Χ ΧΧ•Χ Χ™Χ)
6. [Χ’Χ™Χ‘Χ•Χ™ Χ•Χ©Χ—Χ–Χ•Χ¨ Χ ΧΧ•Χ Χ™Χ](#Χ’Χ™Χ‘Χ•Χ™-Χ•Χ©Χ—Χ–Χ•Χ¨-Χ ΧΧ•Χ Χ™Χ)
7. [Χ©ΧΧ‘ Χ‘ β€“ Χ©ΧΧ™ΧΧΧ•Χ Χ•ΧΆΧ“Χ›Χ•Χ Χ™Χ](#Χ“Χ•Χ—-Χ¤Χ¨Χ•Χ™Χ§Χ--Χ©ΧΧ‘-Χ‘)

---

## ΧΧ‘Χ•Χ

### ΧΧ™ΧΧ•Χ¨ Χ”Χ ΧΧ•Χ Χ™Χ Χ”Χ Χ©ΧΧ¨Χ™Χ Χ‘ΧΧΆΧ¨Χ›Χ:

1. **ΧΧ‘ΧΧ ΧΧ©ΧΧ•ΧΧ™Χ (payment)** β€“ ΧΧ–Χ”Χ”, Χ΅Χ›Χ•Χ, ΧΧΧ¨Χ™Χ, Χ΅Χ•Χ’ (Χ”Χ›Χ Χ΅Χ”/Χ”Χ•Χ¦ΧΧ”)
2. **ΧΧ‘ΧΧ ΧΆΧ•Χ‘Χ“Χ™Χ (employee)** β€“ ΧΧ–Χ”Χ”, Χ©Χ, ΧΧΧ¨Χ™Χ Χ”ΧΧ—ΧΧ”, Χ©Χ›Χ¨
3. **ΧΧ‘ΧΧ ΧΧ§Χ¦Χ™Χ‘Χ™Χ (budgets)** β€“ Χ©Χ Χ”, Χ΅Χ›Χ•Χ
4. **ΧΧ‘ΧΧ Χ”Χ©Χ§ΧΆΧ•Χ (investments)** β€“ ΧΧ–Χ”Χ” Χ”Χ©Χ§ΧΆΧ”, ΧΧ©Χ§Χ™ΧΆ, Χ΅Χ›Χ•Χ, ΧΧ©Χ•ΧΧ”
5. **ΧΧ‘ΧΧ Χ¨Χ›Χ™Χ©Χ•Χ (purchases)** β€“ ΧΧ™Χ“ΧΆ ΧΆΧ ΧΧ” Χ Χ¨Χ›Χ©, Χ›ΧΧ”, Χ•ΧΧ™ Χ¨Χ›Χ©
6. **ΧΧ‘ΧΧ ΧΧ™Χ΅Χ™Χ (taxes)** β€“ Χ΅Χ›Χ•Χ, ΧΧ—Χ•Χ–, Χ›ΧΧΧ™Χ ΧΧ©ΧΧ Χ™Χ
7. **ΧΧ‘ΧΧ ΧΧ©Χ›Χ•Χ¨Χ•Χ (salary)** β€“ Χ‘Χ¨Χ•ΧΧ•, Χ ΧΧ•, Χ”Χ¤Χ¨Χ©Χ™Χ ΧΧ•Χ ΧΧ΅

### Χ”Χ¤Χ•Χ Χ§Χ¦Χ™Χ•Χ ΧΧ™Χ•Χ Χ”ΧΆΧ™Χ§Χ¨Χ™Χ Χ‘ΧΧΆΧ¨Χ›Χ:

- Χ§Χ™Χ©Χ•Χ¨ ΧΧ©ΧΧ•Χ ΧΧ”Χ©Χ§ΧΆΧ•Χ / Χ¨Χ›Χ™Χ©Χ•Χ / ΧΧ©Χ›Χ•Χ¨Χ•Χ
- Χ—Χ™Χ©Χ•Χ‘ Χ©Χ›Χ¨ Χ ΧΧ• ΧΧΧ—Χ¨ Χ Χ™Χ›Χ•Χ™ ΧΧ΅
- Χ Χ™Χ”Χ•Χ ΧΧ§Χ¦Χ™Χ‘ ΧΧ•Χ Χ”Χ›Χ Χ΅Χ•Χ Χ•Χ”Χ•Χ¦ΧΧ•Χ Χ‘Χ¤Χ•ΧΆΧ
- ΧΧΆΧ§Χ‘ ΧΧ—Χ¨ Χ¨Χ›Χ™Χ©Χ•Χ ΧΧ¤Χ™ Χ¦Χ¨Χ›Χ, Χ›ΧΧ•Χ Χ•ΧΧ—Χ™Χ¨
- Χ—Χ™Χ©Χ•Χ‘ ΧΧ΅Χ™Χ ΧΧ¤Χ™ Χ—Χ•Χ§Χ™Χ ΧΧ•ΧΧΧΧ™Χ

---

## ΧΧ¨Χ©Χ™Χ ERD

![ERD](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%90/ERD.png?raw=true)

---

## ΧΧ¨Χ©Χ™Χ DSD

![DSD](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%90/DSD.png?raw=true)

---

## Χ”Χ—ΧΧΧ•Χ ΧΆΧ™Χ¦Χ•Χ‘

1. Χ¨Χ™Χ›Χ•Χ– Χ›Χ Χ΅Χ•Χ’Χ™ Χ”ΧΧ©ΧΧ•ΧΧ™Χ Χ‘ΧΧ‘ΧΧ” ΧΧ—Χ (`payment`) ΧΧ Χ™Χ”Χ•Χ ΧΧ—Χ™Χ“ Χ•Χ§Χ.
2. Χ§Χ™Χ©Χ•Χ¨ Χ™Χ©Χ™Χ¨ Χ‘Χ™Χ `payment` ΧΧ‘Χ™Χ Χ”Χ©Χ§ΧΆΧ•Χ, Χ¨Χ›Χ™Χ©Χ•Χ Χ•ΧΧ©Χ›Χ•Χ¨Χ•Χ β€“ ΧΧ©Χ ΧΧΆΧ§Χ‘ Χ‘Χ¨Χ•Χ¨ ΧΧ—Χ¨Χ™ ΧΧ§Χ•Χ¨ Χ”Χ”Χ•Χ¦ΧΧ”/Χ”Χ›Χ Χ΅Χ”.
3. Χ¤Χ™Χ¦Χ•Χ Χ¨Χ›Χ™Χ©Χ•Χ ΧΧ¨Χ›Χ™Χ©Χ•Χ Χ›ΧΧΧ™Χ•Χ Χ•Χ¨Χ›Χ™Χ‘Χ™ Χ¨Χ›Χ™Χ©Χ” β€“ ΧΧ¤Χ™Χ¨Χ•Χ ΧΧΧ Χ©Χ ΧΧ” Χ Χ§Χ Χ”.
4. Χ”Χ¤Χ¨Χ“Χ ΧΧ©Χ›Χ•Χ¨Χ•Χ β€“ ΧΧΧ¤Χ©Χ¨Χ ΧΧ—Χ©Χ‘ Χ©Χ›Χ¨ Χ ΧΧ• ΧΧ¤Χ™ Χ—Χ•Χ§Χ™ ΧΧ΅ ΧΧ©ΧΧ Χ™Χ.
5. Χ©Χ™ΧΧ•Χ© Χ‘ΧΧ‘ΧΧ ΧΧ§Χ¦Χ™Χ‘Χ™Χ β€“ ΧΧΧΆΧ§Χ‘ Χ©Χ ΧΧ™ Χ•ΧΧ”Χ©Χ•Χ•ΧΧ” ΧΧ•Χ Χ”Χ•Χ¦ΧΧ•Χ.
6. Χ©ΧΧ™Χ¨Χ ΧΧ—Χ•Χ–Χ™ ΧΧ΅ Χ‘ΧΧ‘ΧΧ” Χ Χ¤Χ¨Χ“Χ β€“ Χ›Χ Χ Χ™ΧΧ ΧΧΆΧ“Χ›Χ Χ—Χ•Χ§Χ™Χ Χ‘ΧΧ™ ΧΧ©Χ Χ•Χ ΧΧ ΧΧ‘Χ Χ” Χ”ΧΧ‘ΧΧΧ•Χ.

---

## Χ©Χ™ΧΧ•Χ Χ”Χ›Χ Χ΅Χ Χ ΧΧ•Χ Χ™Χ

### 1. Χ©Χ™ΧΧ•Χ© Χ‘ΦΎMockaroo

[mockarooFiles](https://github.com/estisellam/department-finance---winery/tree/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%90/mockarooFiles)

### 2. Χ©Χ™ΧΧ•Χ© Χ‘ΦΎGENERATEDATA

[generatedataFiles](https://github.com/estisellam/department-finance---winery/tree/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%90/generatedataFiles)

### 3. Χ΅Χ§Χ¨Χ™Χ¤Χ Χ‘ΦΎPython

[scripts folder](https://github.com/estisellam/department-finance---winery/tree/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%90/python_script)

---

## Χ’Χ™Χ‘Χ•Χ™ Χ•Χ©Χ—Χ–Χ•Χ¨ Χ ΧΧ•Χ Χ™Χ

![Backup](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%90/%D7%A6%D7%99%D7%9C%D7%95%D7%9D%20%D7%9E%D7%A1%D7%9A%202025-05-02%20%D7%91-9.34.22.png?raw=true)

**Χ§Χ•Χ‘Χ¥ Χ”Χ’Χ™Χ‘Χ•Χ™:** `gibuy.sql`  
**Χ§Χ•Χ‘Χ¥ Χ”Χ©Χ—Χ–Χ•Χ¨:** `insertTables.sql`  
Χ‘Χ•Χ¦ΧΆ Χ©Χ™ΧΧ•Χ© Χ‘ΦΎpgAdmin ΧΧ™Χ™Χ¦Χ•Χ Χ•Χ©Χ—Χ–Χ•Χ¨ Χ”Χ ΧΧ•Χ Χ™Χ.

---

# Χ“Χ•Χ— Χ¤Χ¨Χ•Χ™Χ§Χ β€“ Χ©ΧΧ‘ Χ‘
## π”Ή Χ©ΧΧ™ΧΧΧ•Χ select
### 1. Χ›Χ Χ”ΧΆΧ•Χ‘Χ“Χ™Χ Χ©ΧΧ—Χ¨ΧΧ™Χ ΧΆΧ Χ”Χ©Χ§ΧΆΧ•Χ, ΧΧΧ•Χ™Χ Χ™Χ ΧΧ¤Χ™ ΧΧ³-Χ‘Χ³
```sql
SELECT DISTINCT e.e_id, e.e_name
FROM employee e
NATURAL JOIN payment p
NATURAL JOIN in_Investments i
;ORDER BY e.e_name ASC
```
![](DBProject/Χ©ΧΧ‘%20Χ‘/Χ¦Χ™ΧΧ•Χ%20ΧΧ΅Χ%202025-05-11%20Χ‘-11.24.02select4select1.png)
![](DBProject/Χ©ΧΧ‘%20Χ‘/Χ¦Χ™ΧΧ•Χ%20ΧΧ΅Χ%202025-05-11%20Χ‘-11.24.16select4select1.png)
![](DBProject/Χ©ΧΧ‘%20Χ‘/Χ¦Χ™ΧΧ•Χ%20ΧΧ΅Χ%202025-05-11%20Χ‘-11.24.19select4select1.png)
---

### 2. Χ›Χ Χ”Χ¨Χ›Χ™Χ©Χ•Χ Χ©Χ”ΧΧ‘Χ¦ΧΆΧ• Χ‘ΧΧΧ¨Χ™Χ 2024-06-19
```sql
SELECT p.p_id, p.p_date, i.id_Consumer
FROM payment p
NATURAL JOIN in_Purchases_from i
WHERE p.p_date = '2024-06-19';
```
![](DBProject/Χ©ΧΧ‘%20Χ‘/Χ¦Χ™ΧΧ•Χ%20ΧΧ΅Χ%202025-05-11%20Χ‘-11.30.40select2.png)
![](DBProject/Χ©ΧΧ‘%20Χ‘/Χ¦Χ™ΧΧ•Χ%20ΧΧ΅Χ%202025-05-11%20Χ‘-11.30.44select2.png)
---
### 3. Χ›Χ Χ”ΧΆΧ•Χ‘Χ“Χ™Χ Χ©Χ”ΧΧ—Χ™ΧΧ• ΧΧΆΧ‘Χ•Χ“ ΧΧ¤Χ Χ™ 2020
```sql
SELECT e_id, e_name, job_start_date
FROM employee
WHERE job_start_date < '2020-01-01'
ORDER BY job_start_date ASC;
```
![](DBProject/Χ©ΧΧ‘%20Χ‘/Χ¦Χ™ΧΧ•Χ%20ΧΧ΅Χ%202025-05-11%20Χ‘-11.37.15select3.png)
![](DBProject/Χ©ΧΧ‘%20Χ‘/Χ¦Χ™ΧΧ•Χ%20ΧΧ΅Χ%202025-05-11%20Χ‘-11.37.18select3.png)
---

### 4. Χ΅Χ Χ›Χ Χ”Χ΅Χ›Χ•Χ Χ©Χ ΧΧ©ΧΧ•ΧΧ™Χ Χ Χ›Χ Χ΅Χ™Χ Χ‘Χ›Χ Χ©Χ Χ”
```sql
SELECT p_year, SUM(p_sum) AS total_income
FROM payment
WHERE in_or_out = 'in'
GROUP BY p_year
ORDER BY p_year;
```
![](DBProject/Χ©ΧΧ‘%20Χ‘/Χ¦Χ™ΧΧ•Χ%20ΧΧ΅Χ%202025-05-11%20Χ‘-11.38.02select4.png)
![](DBProject/Χ©ΧΧ‘%20Χ‘/Χ¦Χ™ΧΧ•Χ%20ΧΧ΅Χ%202025-05-11%20Χ‘-11.38.06select4.png)
### 5. ΧΆΧ•Χ‘Χ“Χ™Χ ΧΆΧ Χ©Χ›Χ¨ Χ’Χ‘Χ•Χ” Χ•ΧΧ—Χ¨Χ™Χ•Χ ΧΦΎ3+ ΧΧ©ΧΧ•ΧΧ™Χ
```sql
SELECT e.e_id, e.e_name, e.salary
FROM employee e
NATURAL JOIN payment p
GROUP BY e.e_id, e.e_name, e.salary
HAVING e.salary > 10000 AND COUNT(p.p_id) > 3;
```
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select05-before.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select05-run.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select05-result.png)

---

### 6. Χ›Χ Χ”Χ”Χ›Χ Χ΅Χ•Χ ΧΧ©Χ Χ 2023
```sql
SELECT p.*
FROM payment p 
JOIN budgets b ON p.p_year = b.b_year 
WHERE p.p_year = 2023 AND p.in_or_out = 'in';
```
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select06-before.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select06-run.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select06-result.png)

---

### 7. ΧΆΧ•Χ‘Χ“Χ™Χ ΧΆΧ Χ”Χ¤Χ¨Χ© Χ©Χ›Χ¨ Χ ΧΧ• β‰¤ 2000
```sql
SELECT e.e_id, e.e_name, e.salary, s.neto_salary
FROM employee e
NATURAL JOIN salary s
WHERE (e.salary - s.neto_salary) <= 2000;
```
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select07-before.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select07-run.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select07-result.png)

---

### 8. Χ¦Χ¨Χ›Χ Χ™Χ ΧΆΧ Χ¤Χ—Χ•Χ ΧΦΎ2 Χ¨Χ›Χ™Χ©Χ•Χ Χ‘ΦΎ2023
```sql
SELECT i.id_Consumer, COUNT(*) AS total_purchases
FROM in_Purchases_from i
NATURAL JOIN payment p
WHERE EXTRACT(YEAR FROM p.p_date) = 2023
GROUP BY i.id_Consumer
HAVING COUNT(*) < 2;
```
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select08-before.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select08-run.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/select08-result.png)

---

## π”Ή Χ©ΧΧ™ΧΧΧ•Χ UPDATE

### 1. ΧΆΧ“Χ›Χ•Χ ΧΧ—Χ•Χ– Χ¨Χ•Χ•Χ— ΧΧΧ©Χ§Χ™ΧΆΧ™Χ ΧΆΧ ΧΧ©ΧΧ•Χ ΧΧΆΧ 10,000
```sql
UPDATE Investments
SET profit_Percentage = 15
WHERE id_Investor IN (
  SELECT ii.id_Investor
  FROM in_Investments ii
  NATURAL JOIN payment p
  WHERE p.p_sum > 10000
);
```
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/update01-before.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/update01-run.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/update01-after.png)

---

### 2. Χ”ΧΆΧΧΧ Χ©Χ›Χ¨ Χ‘ΦΎ10% ΧΧΆΧ•Χ‘Χ“Χ™Χ ΧΆΧ 3+ ΧΧΧ•Χ©Χ™ Χ©Χ›Χ¨
```sql
UPDATE employee
SET salary = salary * 1.10
WHERE e_id IN (
  SELECT e_id
  FROM salary
  GROUP BY e_id
  HAVING COUNT(*) >= 3
);
```
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/update02-before.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/update02-run.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/update02-after.png)

---

### 3. Χ”Χ•Χ¨Χ“Χ ΧΧ—Χ•Χ– ΧΧ΅ ΧΦΎ8% ΧΆΧ‘Χ•Χ¨ ΧΧ©ΧΧ•ΧΧ™Χ ΧΦΎ2022
```sql
UPDATE taxes
SET percent = 8
WHERE t_id IN (
  SELECT ot.t_id
  FROM out_taxes ot
  NATURAL JOIN payment p
  WHERE p.p_year = 2022
);
```
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/update03-before.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/update03-run.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/update03-after.png)

---

## π”Ή Χ©Χ™ΧΧ•Χ© Χ‘ΦΎROLLBACK
```sql
BEGIN;
UPDATE employee
SET salary = salary + 123
WHERE e_id = 200;
ROLLBACK;
```
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/rollback-before.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/rollback-run.png)
![](DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/rollback-result.png)

---
## π”Ή Χ©Χ™ΧΧ•Χ© Χ‘ΦΎCOMMIT

```sql
BEGIN;
UPDATE employee
SET salary = salary + 123
WHERE e_id = 200;
COMMIT;
```

![ΧΧ¤Χ Χ™](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/commit-before.png?raw=true)  
![Χ”Χ¨Χ¦Χ”](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/commit-run.png?raw=true)  
![ΧΧ•Χ¦ΧΧ”](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/commit-result.png?raw=true)

---


## Χ©ΧΧ™ΧΧΧ•Χ DELETE
### 1. ΧΧ—Χ™Χ§Χ Χ¨Χ›Χ™Χ©Χ•Χ ΧΧ”Χ™Χ§Χ‘ Χ©Χ‘Χ•Χ¦ΧΆΧ• ΧΧ¤Χ Χ™ Χ©Χ Χ 2023
```sql
BEGIN;
DELETE FROM out_Purchase_for_the_winery
WHERE p_id IN (
  SELECT pfw.p_id
  FROM out_Purchase_for_the_winery pfw
  NATURAL JOIN payment p
  WHERE p.p_date < '2023-01-01'
);
ROLLBACK;
```
![](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/delete%201.png)


### 2. ΧΧ—Χ™Χ§Χ Χ›Χ Χ”Χ¦Χ¨Χ›Χ Χ™Χ Χ©Χ‘Χ™Χ¦ΧΆΧ• Χ¤Χ—Χ•Χ ΧΦΎ2 Χ¨Χ›Χ™Χ©Χ•Χ

```sql
BEGIN;
DELETE FROM Purchase_from_the_winery
WHERE id_Consumer IN (
  SELECT id_Consumer
  FROM in_Purchases_from
  GROUP BY id_Consumer
  HAVING COUNT(*) < 2
);
ROLLBACK;
```
![](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/delete%202.png)

### 3. ΧΧ—Χ™Χ§Χ Χ¦Χ¨Χ›Χ Χ™Χ Χ©ΧΧ Χ‘Χ™Χ¦ΧΆΧ• ΧΧ£ Χ¨Χ›Χ™Χ©Χ” Χ‘Χ©Χ Χ 2024
```sql
BEGIN;
DELETE FROM Purchase_from_the_winery
WHERE id_Consumer IN (
  SELECT DISTINCT pf.id_Consumer
  FROM in_Purchases_from pf
  WHERE pf.id_Consumer NOT IN (
    SELECT pf2.id_Consumer
    FROM in_Purchases_from pf2
    NATURAL JOIN payment p
    WHERE EXTRACT(YEAR FROM p.p_date) = 2024
  )
);
ROLLBACK;
```
![](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/delete%203.png)
## π”Ή ΧΧ™ΧΧ•Χ¦Χ™Χ
### 1. ΧΧ™ΧΧ•Χ¥ NOT NULL ΧΆΧ ΧΧΧ¨Χ™Χ Χ‘ΧΧ©ΧΧ•ΧΧ™Χ
```sql
ALTER TABLE payment
ALTER COLUMN p_date SET NOT NULL;

-- Χ Χ™Χ΅Χ™Χ•Χ Χ”Χ¤Χ¨Χ”
INSERT INTO payment (p_id, p_date, p_sum, in_or_out)
VALUES (501, NULL, 5000, 'in');
```
---
![](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/Constraints1.png)
### 2. ΧΧ™ΧΧ•Χ¥ ΧΆΧ Χ©Χ›Χ¨- Χ©Χ™Χ”Χ™Χ” Χ¨Χ§ Χ—Χ™Χ•Χ‘
```sql
-- Χ”Χ•Χ΅Χ¤Χ Χ”ΧΧ™ΧΧ•Χ¥
ALTER TABLE employee
ADD CONSTRAINT check_positive_salary
CHECK (salary > 0);

-- Χ Χ™Χ΅Χ™Χ•Χ ΧΧ”Χ¤Χ¨Χ Χ”ΧΧ™ΧΧ•Χ¥
INSERT INTO employee (e_id, e_name, start_date, salary)
VALUES (300, 'Χ“Χ•Χ’ΧΧ”', '2025-01-01', -1000);

```
---
![](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/Constraints%202.png)
### 3. ΧΧ™ΧΧ•Χ¥ ΧΆΧ ΧΧ™Χ΅Χ™Χ- ΧΆΧ¨Χ Χ‘Χ¨Χ™Χ¨Χ Χ”ΧΧ—Χ“Χ Χ©Χ Χ©Χ™ΧΆΧ•Χ¨ Χ”ΧΧ΅- 17%

```sql
-- Χ”Χ•Χ΅Χ¤Χ Χ”ΧΧ™ΧΧ•Χ¥
ALTER TABLE taxes
ALTER COLUMN percent SET DEFAULT 17;

-- Χ”Χ›Χ Χ΅Χ Χ¨Χ©Χ•ΧΧ” ΧΧΧ Χ¦Χ™Χ•Χ ΧΧ—Χ•Χ– Χ”ΧΧ΅
INSERT INTO taxes (t_id, taxname, principal_amount)
VALUES (999, 'ΧΧ΅ Χ Χ™Χ΅Χ™Χ•Χ', 10000);

-- Χ‘Χ“Χ™Χ§Χ Χ”ΧΆΧ¨Χ Χ©Χ Χ§Χ‘ΧΆ
SELECT * FROM taxes WHERE t_id = 999;

```

---
![](https://github.com/estisellam/department-finance---winery/blob/main/DBProject/%D7%A9%D7%9C%D7%91%20%D7%91/Constraints%203.png)
